using System.Data;
using System.Data.SqlClient;


namespace crud
{
    public partial class Form1 : Form
    {
        SqlConnection con = new SqlConnection("Data Source=DESKTOP-PA7QEBH;Initial Catalog=crud;Integrated Security=True;TrustServerCertificate=True");
        public Form1()
        {
            InitializeComponent();
        }

        private void bind_data()
        {
            SqlCommand cmd1 = new SqlCommand("Select ID,fname As namadepan,lname As namabelakang, nilai from crud", con);
            SqlDataAdapter da = new SqlDataAdapter();
            da.SelectCommand = cmd1;
            DataTable dt = new DataTable();
            dt.Clear();
            da.Fill(dt);
            dataGridView1.DataSource = dt;
            dataGridView1.ColumnHeadersDefaultCellStyle.Font = new Font("Tahoma", 11, FontStyle.Bold);
            dataGridView1.DefaultCellStyle.Font = new Font("Arial", 12);
        }
        private void label2_Click(object sender, EventArgs e)
        {

        }

        private void label4_Click(object sender, EventArgs e)
        {

        }

        private void textBox1_TextChanged(object sender, EventArgs e)
        {

        }

        private void btnClose_Click(object sender, EventArgs e)
        {
            DialogResult result = MessageBox.Show("Anda yakin akan keluar?", "Konfirmasi", MessageBoxButtons.OKCancel, MessageBoxIcon.Question);
            if (result == DialogResult.OK)
            {
                Application.Exit();
            }
        }

        private void btnInsert_Click(object sender, EventArgs e)
        {
            SqlCommand cmd2 = new SqlCommand("Insert into crud(ID,fname,lname,nilai)Values(@NoID,@Namadepan,@Namabelakang,@Nilai)",con);
            cmd2.Parameters.AddWithValue("NoID", txtID.Text);
            cmd2.Parameters.AddWithValue("Namadepan", txtNamaDpn.Text);
            cmd2.Parameters.AddWithValue("Namabelakang", txtNamaBkg.Text);
            cmd2.Parameters.AddWithValue("Nilai", txtNilai.Text);
            con.Open();
            cmd2.ExecuteNonQuery();
            con.Close();
            bind_data();
        }
    }
}
